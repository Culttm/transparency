/*!
* transparency - v0.9.1 - 2013-02-19
* https://github.com/leonidas/transparency
* Copyright (c) 2013 Jarno Keskikangas <jarno.keskikangas@leonidasoy.fi>; Licensed MIT
*/
(function(){var t,e,n,r,i,o,u,s,l,h,a,c,p,f,d,m,y,v,g,b,_,N,x,C,A,T,w,j,V,E,D,S,L,M,Q,k,B=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},H={}.hasOwnProperty,O=function(t,e){function n(){this.constructor=t}for(var r in e)H.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};v=function(t){return function(e){return function(){return t.apply(this,arguments),e.apply(this,arguments)}}},y=function(t){return function(e){return function(){return e.apply(this,arguments),t.apply(this,arguments)}}},g=y(function(){return this}),C=function(t){var e,n;for(n=[],e=t.firstChild;e;)n.push(e),e=e.nextSibling;return n},A=function(t){var e;return e=[],Q(t,e),e},Q=function(t,e){var n,r;for(n=t.firstChild,r=[];n;)n.nodeType===o&&(e.push(new s.createElement(n)),Q(n,e)),r.push(n=n.nextSibling);return r},o=1,p=3,T=function(){return"<:nav></:nav>"!==document.createElement("nav").cloneNode(!0).outerHTML},b="undefined"==typeof document||null===document||T()?function(t){return t.cloneNode(!0)}:function(t){var e,n,r,i,u;if(e=d.clone(t),e.nodeType===o)for(e.removeAttribute(x),u=e.getElementsByTagName("*"),r=0,i=u.length;i>r;r++)n=u[r],n.removeAttribute(x);return e},x="transparency",N=function(t){return t[x]||(t[x]={})},L=function(){},_=function(){return console.log(arguments)},S=L,M=Object.prototype.toString,w=Array.isArray||function(t){return"[object Array]"===M.call(t)},V=function(t){return"[object Date]"===M.call(t)},E=function(t){return t.nodeType===o},D=function(t){var e;return e=typeof t,"object"!==e&&"function"!==e||V(t)},j=function(t){return t===!0||t===!1},d=this.Transparency={},d.render=function(t,e,n,r){var o;return null==e&&(e=[]),null==n&&(n={}),null==r&&(r={}),S=r.debug&&console?_:L,S("Transparency.render:",t,e,n,r),t?(w(e)||(e=[e]),t=(o=N(t)).context||(o.context=new i(t)),t.render(e,n,r).el):void 0},d.jQueryPlugin=g(function(t,e,n){var r,i,o,u;for(u=[],i=0,o=this.length;o>i;i++)r=this[i],u.push(d.render(r,t,e,n));return u}),d.matcher=function(t,e){return t.el.id===e||B.call(t.classNames,e)>=0||t.el.name===e||t.el.getAttribute("data-bind")===e},d.clone=function(t){var e;return"function"==typeof(e=jQuery||Zepto)?e(t).clone()[0]:void 0},null!=(k=jQuery||Zepto)&&(k.fn.render=d.jQueryPlugin),("undefined"!=typeof define&&null!==define?define.amd:void 0)&&define(function(){return d}),i=function(){function t(t){this.el=t,this.template=b(this.el),this.instances=[new a(this.el)],this.instanceCache=[]}var e,n;return n=g(function(){return this.parent=this.el.parentNode,this.parent?(this.nextSibling=this.el.nextSibling,this.parent.removeChild(this.el)):void 0}),e=g(function(){return this.parent?this.nextSibling?this.parent.insertBefore(this.el,this.nextSibling):this.parent.appendChild(this.el):void 0}),t.prototype.render=v(n)(y(e)(g(function(t,e,n){for(var r,i,o,u,s,l,h;t.length<this.instances.length;)this.instanceCache.push(this.instances.pop().remove());for(h=[],i=s=0,l=t.length;l>s;i=++s)u=t[i],(o=this.instances[i])||(o=this.instanceCache.pop()||new a(b(this.template)),this.instances.push(o.appendTo(this.el))),r=[],h.push(o.prepare(u,r).renderValues(u,r).renderDirectives(u,i,e).renderChildren(u,r,e,n));return h}))),t}(),a=function(){function t(t){this.queryCache={},this.childNodes=C(t),this.elements=A(t)}return t.prototype.remove=g(function(){var t,e,n,r,i;for(r=this.childNodes,i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(t.parentNode.removeChild(t));return i}),t.prototype.appendTo=g(function(t){var e,n,r,i,o;for(i=this.childNodes,o=[],n=0,r=i.length;r>n;n++)e=i[n],o.push(t.appendChild(e));return o}),t.prototype.prepare=g(function(t){var e,n,r,i,o;for(i=this.elements,o=[],n=0,r=i.length;r>n;n++)e=i[n],e.reset(),o.push(N(e.el).model=t);return o}),t.prototype.renderValues=g(function(t,e){var n,r,i,o;if(E(t)&&(n=this.elements[0]))return n.empty().el.appendChild(t);if("object"==typeof t){o=[];for(r in t)H.call(t,r)&&(i=t[r],null!=i&&(D(i)?o.push(function(){var t,e,o,u;for(o=this.matchingElements(r),u=[],t=0,e=o.length;e>t;t++)n=o[t],u.push(n.render(i));return u}.call(this)):"object"==typeof i?o.push(e.push(r)):o.push(void 0)));return o}}),t.prototype.renderDirectives=g(function(t,e,n){var r,i,o,u;u=[];for(o in n)H.call(n,o)&&(r=n[o],"object"==typeof r&&u.push(function(){var n,u,s,l;for(s=this.matchingElements(o),l=[],n=0,u=s.length;u>n;n++)i=s[n],l.push(i.renderDirectives(t,e,r));return l}.call(this)));return u}),t.prototype.renderChildren=g(function(t,e,n,r){var i,o,u,s,l;for(l=[],u=0,s=e.length;s>u;u++)o=e[u],l.push(function(){var e,u,s,l;for(s=this.matchingElements(o),l=[],e=0,u=s.length;u>e;e++)i=s[e],l.push(d.render(i.el,t[o],n[o],r));return l}.call(this));return l}),t.prototype.matchingElements=function(t){var e,n,r;return n=(r=this.queryCache)[t]||(r[t]=function(){var n,r,i,o;for(i=this.elements,o=[],n=0,r=i.length;r>n;n++)e=i[n],d.matcher(e,t)&&o.push(e);return o}.call(this)),S("Matching elements for '"+t+"':",n),n},t}(),e=function(){function e(){}return e.Attributes={},e.prototype.createAttribute=function(r,i,o){var u;return u=e.Attributes[i]||(j(o)?n:t),new u(r,i)},e}(),t=function(){function t(t,e){this.el=t,this.name=e,this.templateValue=this.el.getAttribute(this.name)||""}return t.prototype.set=function(t){return this.el[this.name]=t,this.el.setAttribute(this.name,""+t)},t}(),n=function(t){function e(t,e){this.el=t,this.name=e,this.templateValue=this.el.getAttribute(this.name)||!1}return O(e,t),e.prototype.set=function(t){return this.el[this.name]=t,t?this.el.setAttribute(this.name,t):this.el.removeAttribute(this.name)},e}(t),f=function(t){function n(t,e){var n;this.el=t,this.name=e,this.templateValue=function(){var t,e,r,i;for(r=C(this.el),i=[],t=0,e=r.length;e>t;t++)n=r[t],n.nodeType===p&&i.push(n.nodeValue);return i}.call(this).join(""),(this.textNode=this.el.firstChild)?this.textNode.nodeType!==p&&(this.textNode=this.el.insertBefore(this.el.ownerDocument.createTextNode(""),this.textNode)):this.el.appendChild(this.textNode=this.el.ownerDocument.createTextNode(""))}return O(n,t),e.Attributes.text=n,n.prototype.set=function(t){return this.textNode.nodeValue=t},n}(t),l=function(t){function n(t){n.__super__.constructor.call(this,t,"innerHTML"),this.childNodes=C(this.el)}return O(n,t),e.Attributes.html=n,n.prototype.set=function(t){var e,n,r,i,o;for(this.el.innerHTML=t,i=this.childNodes,o=[],n=0,r=i.length;r>n;n++)e=i[n],o.push(this.el.appendChild(e));return o},n}(t),r=function(t){function n(t){n.__super__.constructor.call(this,t,"class")}return O(n,t),e.Attributes["class"]=n,n}(t),u=function(){function t(t){this.el=t,this.attributeFactory=new e,this.attributes={},this.childNodes=C(this.el),this.nodeName=this.el.nodeName.toLowerCase(),this.classNames=this.el.className.split(" "),this.originalAttributes={}}return t.prototype.empty=g(function(){var t,e;for(e=[];t=this.el.firstChild;)e.push(this.el.removeChild(t));return e}),t.prototype.reset=function(){var t,e,n,r;n=this.attributes,r=[];for(e in n)t=n[e],r.push(t.set(t.templateValue));return r},t.prototype.render=function(t){return this.attr("text",t)},t.prototype.attr=function(t,e){var n,r;return n=(r=this.attributes)[t]||(r[t]=this.attributeFactory.createAttribute(this.el,t,e)),n.set(e)},t.prototype.renderDirectives=function(t,e,n){var r,i,o,u,s;s=[];for(i in n)H.call(n,i)&&(r=n[i],"function"==typeof r&&(o=r.call(t,{element:this.el,index:e,value:(null!=(u=this.attributes[i])?u.templateValue:void 0)||""}),null!=o?s.push(this.attr(i,o)):s.push(void 0)));return s},t}(),s={elements:{},createElement:function(t){var e;return e=s.elements[t.nodeName.toLowerCase()]||u,new e(t)}},c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return O(e,t),s.elements.select=e,e.prototype.render=function(t){var e,n,r,i,o;for(t=""+t,i=A(this.el),o=[],n=0,r=i.length;r>n;n++)e=i[n],"option"===e.nodeName&&o.push(e.el.selected=e.el.value===t);return o},e}(u),m=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var n,r,i,o;for(O(e,t),n=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],i=0,o=n.length;o>i;i++)r=n[i],s.elements[r]=e;return e.prototype.attr=function(t,n){return"text"!==t&&"html"!==t?e.__super__.attr.call(this,t,n):void 0},e}(u),h=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return O(e,t),s.elements.input=e,e.prototype.render=function(t){return this.attr("value",t)},e}(m)}).call(this);