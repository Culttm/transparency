/*! transparency - v0.8.2 - 2013-02-16
* https://github.com/leonidas/transparency
* Copyright (c) 2013 Jarno Keskikangas <jarno.keskikangas@leonidasoy.fi>; Licensed MIT */
(function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M={}.hasOwnProperty,_=[].slice;i=this.Transparency={},i.render=function(t,n,r,i){var s,o;n==null&&(n=[]),r==null&&(r={}),i==null&&(i={}),s=i.debug&&console?a:T,s("Transparency.render:",t,n,r,i);if(!t)return;return g(n)||(n=[n]),t=(o=f(t)).context||(o.context=new e(t)),t.detach().render(n,r,i).attach()},i.jQueryPlugin=function(e,t,n){var r,s,o;for(s=0,o=this.length;s<o;s++)r=this[s],i.render(r,e,t,n);return this},i.matcher=function(e,t){return e.id===t||m(e.className.split(" "),t)>-1||e.name===t||e.getAttribute("data-bind")===t},i.clone=function(e){var t;return typeof (t=jQuery||Zepto)=="function"?t(e).clone()[0]:void 0},e=function(){function e(e){this.el=e,this.template=u(this.el),this.instances=[new n(this.el,this.el)],this.instanceCache=[]}return e.prototype.detach=function(){return this.parent=this.el.parentNode,this.parent&&(this.nextSibling=this.el.nextSibling,this.parent.removeChild(this.el)),this},e.prototype.attach=function(){return this.parent&&(this.nextSibling?this.parent.insertBefore(this.el,this.nextSibling):this.parent.appendChild(this.el)),this},e.prototype.render=function(e,t,r){var i,s,o,a,f;while(e.length<this.instances.length)this.instanceCache.push(this.instances.pop().remove());for(i=a=0,f=e.length;a<f;i=++a)o=e[i],(s=this.instances[i])||(s=this.instanceCache.pop()||new n(u(this.template)),this.instances.push(s.appendTo(this.el))),s.reset().render(o,i,t,r);return this},e}(),n=function(){function e(e){this.queryCache={},this.childNodes=h(e),this.elements=p(e)}return e.prototype.remove=function(){var e,t,n,r;r=this.childNodes;for(t=0,n=r.length;t<n;t++)e=r[t],e.parentNode.removeChild(e);return this},e.prototype.appendTo=function(e){var t,n,r,i;i=this.childNodes;for(n=0,r=i.length;n<r;n++)t=i[n],e.appendChild(t);return this},e.prototype.reset=function(){var e,t,n,r,i,s,u;s=this.elements;for(r=0,i=s.length;r<i;r++){t=s[r],u=f(t).originalAttributes;for(e in u)n=u[e],o(t,e,n)}return this},e.prototype.render=function(e,t,n,r){var i,s,u,a,f,c,h,p;i=[],this.assoc(e);if(w(e)&&(s=this.elements[0]))l(s).appendChild(e);else if(typeof e=="object")for(u in e){if(!M.call(e,u))continue;f=e[u];if(f!=null)if(E(f)){p=this.matchingElements(u);for(c=0,h=p.length;c<h;c++)s=p[c],a=s.nodeName.toLowerCase(),a==="input"?o(s,"value",f):a==="select"?o(s,"selected",f):o(s,"text",f)}else typeof f=="object"&&i.push(u)}return this.renderDirectives(e,t,n),this.renderChildren(e,i,n,r),this},e.prototype.assoc=function(e){var t,n,r,i,s;i=this.elements,s=[];for(n=0,r=i.length;n<r;n++)t=i[n],s.push(f(t).model=e);return s},e.prototype.renderValues=function(){},e.prototype.renderDirectives=function(e,t,n){var r,i,s,u,a,f,l;if(!n)return;e=typeof e=="object"?e:{value:e},l=[];for(a in n){if(!M.call(n,a))continue;i=n[a],typeof i=="object"&&l.push(function(){var n,l,c,h;c=this.matchingElements(a),h=[];for(n=0,l=c.length;n<l;n++)u=c[n],h.push(function(){var n;n=[];for(r in i){s=i[r];if(typeof s!="function")continue;f=s.call(e,{element:u,index:t,value:o(u,r)}),n.push(o(u,r,f))}return n}());return h}.call(this))}return l},e.prototype.renderChildren=function(e,t,n,r){var s,o,u,a,f;f=[];for(u=0,a=t.length;u<a;u++)o=t[u],f.push(function(){var t,u,a,f;a=this.matchingElements(o),f=[];for(t=0,u=a.length;t<u;t++)s=a[t],f.push(i.render(s,e[o],n[o],r));return f}.call(this));return f},e.prototype.matchingElements=function(e){var t,n,r;return n=(r=this.queryCache)[e]||(r[e]=function(){var n,r,s,o;s=this.elements,o=[];for(n=0,r=s.length;n<r;n++)t=s[n],i.matcher(t,e)&&o.push(t);return o}.call(this)),x("Matching elements for '"+e+"':",n),n},e}(),h=function(e){var t,n;n=[],t=e.firstChild;while(t)n.push(t),t=t.nextSibling;return n},p=function(e){var t;return t=[],A(e,t),t},A=function(e,n){var r,i,s;r=e.firstChild,s=[];while(r)r.nodeType===t&&((i=f(r)).originalAttributes||(i.originalAttributes={}),n.push(r),A(r,n)),s.push(r=r.nextSibling);return s},N=function(e,n){var r,i,s,o,u,a,c;i=f(e);if(i.html===n)return;i.html=n,i.children||(i.children=function(){var n,r,i,o;i=e.childNodes,o=[];for(n=0,r=i.length;n<r;n++)s=i[n],s.nodeType===t&&o.push(s);return o}()),l(e),e.innerHTML=n,a=i.children,c=[];for(o=0,u=a.length;o<u;o++)r=a[o],c.push(e.appendChild(r));return c},k=function(e,t){var n,i;n=f(e);if(t==null||n.text===t)return;return n.text=t,i=e.firstChild,i?i.nodeType!==r?e.insertBefore(e.ownerDocument.createTextNode(t),i):i.nodeValue=t:e.appendChild(e.ownerDocument.createTextNode(t))},d=function(e){var t;return function(){var n,i,s,o;s=e.childNodes,o=[];for(n=0,i=s.length;n<i;n++)t=s[n],t.nodeType===r&&o.push(t.nodeValue);return o}().join("")},C=function(e,t){var n,r,i,s,o;t=t.toString(),r=[],r=p(e),o=[];for(i=0,s=r.length;i<s;i++)n=r[i],n.nodeName.toLowerCase()==="option"?n.value===t?o.push(n.selected=!0):o.push(n.selected=!1):o.push(void 0);return o},o=function(e,t,n){var r,i,s,o,u,a,l,c,h,p,v;r=f(e);if(n==null)return r.originalAttributes[t];if(e.nodeName.toLowerCase()==="select"&&t==="selected")return C(e,n);switch(t){case"text":if(!S(e))return(l=(i=r.originalAttributes)["text"])==null&&(i.text=d(e)),k(e,n);break;case"html":return(c=(s=r.originalAttributes)["html"])==null&&(s.html=e.innerHTML),N(e,n);case"class":return(h=(o=r.originalAttributes)["class"])==null&&(o["class"]=e.className),e.className=n;default:return e[t]=n,y(n)?((p=(u=r.originalAttributes)[t])==null&&(u[t]=e.getAttribute(t)||!1),n?e.setAttribute(t,t):e.removeAttribute(t)):((v=(a=r.originalAttributes)[t])==null&&(a[t]=e.getAttribute(t)||""),e.setAttribute(t,n.toString()))}},l=function(e){var t;while(t=e.firstChild)e.removeChild(t);return e},t=1,r=3,s=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],v=function(){return document.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>"},u=typeof document=="undefined"||document===null||v()?function(e){return e.cloneNode(!0)}:function(e){var n,r,s,o,u;n=i.clone(e);if(n.nodeType===t){n.removeAttribute(c),u=n.getElementsByTagName("*");for(s=0,o=u.length;s<o;s++)r=u[s],r.removeAttribute(c)}return n},c="transparency",f=function(e){return e[c]||(e[c]={})},T=function(){},a=function(){var e;return e=1<=arguments.length?_.call(arguments,0):[],console.log.apply(console,e)},x=T,L=Object.prototype.toString,b=function(e){return L.call(e)==="[object Date]"},w=function(e){return e.nodeType===t},S=function(e){return m(s,e.nodeName.toLowerCase())>-1},E=function(e){return b(e)||typeof e!="object"&&typeof e!="function"},y=function(e){return e===!0||e===!1},g=Array.isArray||function(e){return L.call(e)==="[object Array]"},m=function(e,t){var n,r,i,s;if(e.indexOf)return e.indexOf(t);for(n=i=0,s=e.length;i<s;n=++i){r=e[n];if(r===t)return n}return-1},(O=jQuery||Zepto)!=null&&(O.fn.render=i.jQueryPlugin),(typeof define!="undefined"&&define!==null?define.amd:void 0)&&define(function(){return i})}).call(this);